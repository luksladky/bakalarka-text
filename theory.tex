\chapter{Theoretical analysis of the~KSA}

Hlavni myslenka, nektere klice jsou pravdepodobnejsi nez jine, z toho vnitrniho stavu!! 







\begin{thm}
	Probability of the product of independent events is the product of probabilities, implicitly assumed it is independent. 
\end{thm}


\begin{notation}
	
	\begin{itemize}
		\item 	$ \K{a}{b} \coloneqq \sum\limits_{i=a}^{b}K[i]$
		
		\item 	Let $ j_{i} $ be the pointer $ j $ in i-th round of the KSA. 
	\end{itemize}
	
\end{notation}

\section{Roos bias}
	\begin{lemma}
		TODO prerekvizita vety 1
	\end{lemma}
	
	\begin{lemma}
		TODO prerekvizita vety 1
	\end{lemma}
	
	
	\begin{thm}{\cite{GoMa}}
		Assume that during the KSA the index j takes its values uniformly at random from $ \Z_{N} $. Then $ \forall 0 \leq i \leq r-1, 1 \leq r \leq N $
		
		\[ \Pr(S_{r}[i] = \K{0}{i} + \dfrac{i(i+1)}{2})   \geq (\dfrac{N - i}{N})(\dfrac{N-1}{1})^{\frac{i(i+1)}{2}+r}+\dfrac{1}{N} \]
	\end{thm}
	
	\begin{proof}
		TODO
	\end{proof}
	
	\begin{cor}
		TODO zobecneni na posledni kolo nebo predchozi vetu rovnou smerovat tam?
\end{cor}
	
TODO tabulka s aktualnimi hodnotami 

TODO to same pro InvS


\begin{thm}
	After the complete KSA, 
	\[  \Pr(S_{N}[S_{N}[y]] = \K{0}{i} + \dfrac{i(i+1)}{2}) \approx  \]
	
	clanek 4, appendix, na zacatku graf
\end{thm}

TODO - tabulka s aktualnimi hodnotami, dukaz




TODO zobecneni na sekvence


TODO inverzni sekvence

TODO vyyiti tohoto na ziskani klice - rovnice


\section{Substracting equations}

Let $i_{1} < i_{2} $. If $ C_{i_{1}} = \K{0}{i_{1}} $ and $ C_{i_{2}} = \K{0}{i_{2}} $, then we can substract the values and get
\[ C_{i_{2}} - C_{i_{1}} = \K{0}{i_{2}} - \K{0}{i_{1}} = \K{i_{1} + 1}{i_{2}}	\].

This holds with the product of the individual probabilities of $ C_{i} $


\section{Useful distributions for The Key Recovering Algorithm}

\begin{defn}
If $ j_{i} = S[i] $, we call this as event 1 has occured for index $ i $, and denote as $ E_{1} $.
\end{defn}

\begin{thm}
\[	P(S[i] = j_{i}) \geq (1-\dfrac{1}{N})^{i}(1-\dfrac{i-1}{N})(1-\dfrac{1}{N})^{N-i-1}+ \dfrac{1}{N} \]
\end{thm}

\begin{defn}
	If $ j_{i} = S[i] $, we call this as event 1' has occured for index $ i $, and denote as $ E'_{1} $.
\end{defn}

\begin{thm}
	\[	P(S^{-1}[i] = j_{i}) \geq (\dfrac{i}{N})(1-\dfrac{1}{N})^{N-1}+ \dfrac{1}{N}\]
\end{thm}


\begin{proof}
		$ (1-\dfrac{1}{N})^{i}(\dfrac{i}{N})(1-\dfrac{1}{N})^{N-i-1}+ \dfrac{1}{N} $
\end{proof}

\begin{thm}
	$ P(S[i] = j_{i} \vee S^{-1}[i] = j_{i}) $ used for BuildKeyTable algorithm in paper 1
\end{thm}


TODO $ P(S[S[i]] = j_{i}) $ - dukazy nikde nejsou...

TODO $ P(S^{-1}[S^{-1}[i]] = j_{i}) $

TODO $ P(S[S[S[i]] = j_{i}) $



